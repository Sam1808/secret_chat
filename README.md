# Подключаемся к подпольному чату

## Программа, чтобы через командную строку таскать для *бабы Зины* коды.

### Как развернуть утилиту для *бабы Зины*:

Делаем всё под python 3.7 и выше.

1. Скачайте код:
   ```bash
   git clone https://github.com/Sam1808/secret_chat.git`
   ```
2. Разверните [виртуальное окружение](https://devman.org/encyclopedia/pip/pip_virtualenv/) и зависимости:  
   ```bash
    pip install -r requirements.txt
   ```
3. Создайте конфигурационный файл `config.yaml` со следующим содержимым:

```buildoutcfg
#config.yaml

# URL подпольного чата
chat_url: secret.url.org
# Порт для чтения того самого подпольного чата
receive_port: 0000
# Порт для отправки сообщений в тот самый подпольный чат
send_port: 0000
# Имя файла куда будет сохраняться вся история переписки
history: history.txt
# Токен пользователя, если он у вас есть
token:
# Включить ли DEBUG? (пустое значение - выключен)
debug:
# Зарегистриовать ли нового пользователя? (пустое значение - нет)
new_user:
# Указать свое имя пользователя в чате
name:
```

*На самом деле имя конфигурационного файла не имеет значения. Подробнее ниже.*

### Как *бабе Зине* запустить скрипт для чтения чата:

- если вся конфигурация описана в файле `config.yaml`  
  ```python
   python3 receive.py
  ```
- если вся конфигурация описана в файле `name_of_config_file.yaml`  
  ```python
    python3 receive.py --config name_of_config_file.yaml
  ```
- если вся конфигурация описана, но очень хочется детализировать переменные  
  ```python
    python3 receive.py --url new.secret.url --port 9999 --history new_file.txt
  ```

### Что увидит *баба Зина*:

- всю переписку в консоли
- всю историю переписки, с момента запуска скрипта, в файле истории

### Как *бабе Зине* запустить скрипт для отправки сообщения в чат:

Отправка сообщений с помощью скрипта `send.py`. Отправка чуть сложнее, чем прием, тут появляется
обязательный аргумент командной строки `--message`, иначе что вы собрались отправлять. Итак...  
- если вы отправляете сообщение впервые и у вас нет никаких регистрационных данных, скрипт
автоматически все сделает за вас и сохранит чуствительные данные в `register_info.txt`. Т.об.
```python
python3 send.py --message 'Hello my friends!'
```
- далее скрипт всегда будет отправлять данные от имени зарегистированного пользователя, пока вы 
не удалите `register_info.txt` или явно не укажите `token` другого пользователя, например:  
```python
python3 send.py --message 'Hello my friends!' --token 11223344ldfssdfsdfsd
```
- если имя пользоватея вам надоело, перерегистрируйтесь:  
```python
python3 send.py --message 'Hello my friends!' --new_user=True
```
- если хотите подробно видеть в консоли все происходящее, включите DEBUG:  
```python
python3 send.py --message 'Hello my friends!' --debug=True
```
- а ещё можно явно указать свое имя пользователя, хотя в чате оно будет не особо явное  
```python
python3 send.py --message 'Hello my friends!' --name Zina_super_baba
```

Все указанные опции можно прописать на постоянной основе в `config.yaml`
### Ошибки:

- скрипт будет отказываться запускаться, пока вы не создадите файл конфигурации.
- а ещё он потребует сообщение при отправке
- скрипт не ломается, если символы переноса строки `\n` попали в токен, имя пользователя, или в текст сообщения
